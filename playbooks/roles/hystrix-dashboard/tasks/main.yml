---
- name: Copy jetty app context xml file
  copy: src=hystrix-dashboard.xml dest={{ webapps_root }}/hystrix-dashboard.xml owner={{ jetty_user }} group={{ jetty_group }} mode=0644
  notify: restart webapps container
  when: servlet_container == "jetty9"

- name: Download build of hystrix-dashboard
  get_url: url={{ hystrix_dashboard_build_url }} dest=/tmp/hystrix-dashboard.war
  
- name: Remove any old version
  file: path={{ webapps_root }}/hystrix-dashboard state=absent
  
- name: Create hystrix-dashboard deployment directory
  file: path={{ webapps_root }}/hystrix-dashboard state=directory

- name: Decompress hystrix-dashboard WAR file
  command: chdir={{ webapps_root }}/hystrix-dashboard unzip /tmp/hystrix-dashboard.war
  notify: restart webapps container
  
- name: Remove source WAR file
  file: path=/tmp/hystrix-dashboard.war state=absent
  notify: restart webapps container

